"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _polythenePolythenePolythene=require("polythene/polythene/polythene");var _polythenePolythenePolythene2=_interopRequireDefault(_polythenePolythenePolythene);var _mithril=require("mithril");var _mithril2=_interopRequireDefault(_mithril);var _polytheneRippleRipple=require("polythene/ripple/ripple");var _polytheneRippleRipple2=_interopRequireDefault(_polytheneRippleRipple);var _polytheneShadowShadow=require("polythene/shadow/shadow");var _polytheneShadowShadow2=_interopRequireDefault(_polytheneShadowShadow);require("polythene-theme/button/button");var tapStart=undefined,tapEnd=undefined;var initTapEvents=function initTapEvents(el,ctrl,opts){var tapHandler=function tapHandler(evt){var baseZ=ctrl.baseZ();if(baseZ===5){return}var MAX_Z=5;var increase=opts.increase||1;var z=ctrl.z();if(evt==="down"){z=z+increase;z=Math.min(z,MAX_Z)}else if(evt==="up"){z=z-increase;z=Math.max(z,baseZ)}ctrl.z(z);_mithril2["default"].redraw()};tapStart=function(){tapHandler("down")};tapEnd=function(){tapHandler("up")};el.addEventListener("mousedown",tapStart);el.addEventListener("mouseup",tapEnd)};var clearTapEvents=function clearTapEvents(el){el.removeEventListener("mousedown",tapStart);el.removeEventListener("mouseup",tapEnd)};var createView=function createView(ctrl){var opts=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var tag=undefined,label=undefined;opts.ripple=opts.ripple||{};opts.shadow=opts.shadow||{};tag=opts.tag||"a";var noink=opts.ink!==undefined&&!opts.ink;var disabled=opts.disabled===true;if(disabled){tag+="[disabled]"}if(noink){tag+=".noink"}if(opts.raised){tag+=".raised"}var props0={"class":[opts.parentClass||"button",opts.selected?"selected":null,opts["class"]].join(" ")};var props=!disabled?Object.assign({},props0,{config:function config(el,isInited,context){if(opts.config){opts.config(el,isInited,context)}if(isInited){return}initTapEvents(el,ctrl,opts.shadow);context.onunload=function(){clearTapEvents(el)}}},opts.url?opts.url:null,opts.events?opts.events:null):props0;label=null;if(opts.content){label=opts.content}else if(opts.label){if(typeof opts.label==="object"){label=opts.label}else{label=(0,_mithril2["default"])(".label",opts.label)}}var content=(0,_mithril2["default"])("div",{"class":"content"},[label,disabled||noink?null:_mithril2["default"].component(_polytheneRippleRipple2["default"],opts.ripple),disabled||opts.wash!==undefined&&!opts.wash?null:(0,_mithril2["default"])(".wash.fit"),opts.raised&&!disabled?_mithril2["default"].component(_polytheneShadowShadow2["default"],{z:ctrl.z(),animated:true}):null]);return(0,_mithril2["default"])(tag,props,_polythenePolythenePolythene2["default"].insertContent(content,opts))};var component={controller:function controller(){var opts=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];var z=opts.z!==undefined?opts.z:1;return{baseZ:_mithril2["default"].prop(z),z:_mithril2["default"].prop(z)}},view:function view(ctrl){var opts=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return createView(ctrl,opts)}};exports["default"]=component;module.exports=exports["default"];